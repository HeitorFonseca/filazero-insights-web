<div class="card-deck col-12">
  <div class="card col-3 example-container">
    <h5 class="card-title">Linhas</h5>
    <div
      id="dimensoesIn"
      cdkDropList
      [cdkDropListData]="dimensoesIn"
      [cdkDropListConnectedTo]="['dimensoesOut']"
      class="example-list"
      (cdkDropListDropped)="drop($event)">
        <div
          class="example-box"
          *ngFor="let dim of dimensoesIn"
          cdkDrag
          [cdkDragData]="dim">{{dim}}</div>
    </div>
  </div>
  <div class="card col-3 example-container">
    <h5 class="card-title">Colunas</h5>  
    <div
      id="colunasIn"
      cdkDropList
      [cdkDropListData]="colunasIn"
      [cdkDropListConnectedTo]="['dimensoesOut']"
      class="example-list"
      (cdkDropListDropped)="drop($event)">
        <div
          class="example-box"
          *ngFor="let dim of colunasIn"
          cdkDrag
          [cdkDragData]="dim">{{dim}}</div>
    </div> 
  </div>
  <div class="card col-3 example-container">
    <h5 class="card-title">Métricas</h5>
    <div
      id="metricasin"
      cdkDropList
      [cdkDropListData]="metricasIn"
      cdkDropListConnectedTo="metricasout"
      class="example-list"
      (cdkDropListDropped)="drop($event)">
      <div
        class="example-box"
        *ngFor="let metrica of metricasIn"
        cdkDrag
        [cdkDragData]="metrica">{{metrica}}</div>
    </div>
  </div>
  <div class="card col-3 example-container">
      <h5 class="card-title">Filtros</h5>
  </div>
</div>
<div class="row">
<div id="table-section" class="col-9">
  <table mat-table id='performanceServico'
    [dataSource]="dataSource" multiTemplateDataRows
    class="mat-elevation-z8">
    <ng-container [matColumnDef]="column" *ngFor="let column of columnsToDisplay">
      <th mat-header-cell *matHeaderCellDef> {{column | uppercase}} </th>
      <td mat-cell *matCellDef="let element"> {{element[column]}} </td>
    </ng-container>
    <!--<ng-container matColumnDef="agendados">
      <th mat-header-cell *matHeaderCellDef> AGENDADOS </th>
      <td mat-cell *matCellDef="let element"> {{element.agendados}} </td>
      <td mat-footer-cell *matFooterCellDef> {{ getTotalAgendados() }} </td>
    </ng-container>
    <ng-container matColumnDef="concluidos">
      <th mat-header-cell *matHeaderCellDef> CONCLUÍDOS </th>
      <td mat-cell *matCellDef="let element"> {{element.concluidos}} </td>
      <td mat-footer-cell *matFooterCellDef> {{ getTotalConcluidos() }} </td>
    </ng-container>
    <ng-container matColumnDef="cancelados">
      <th mat-header-cell *matHeaderCellDef> CANCELADOS </th>
      <td mat-cell *matCellDef="let element"> {{element.cancelados}} </td>
      <td mat-footer-cell *matFooterCellDef> {{ getTotalCancelados() }} </td>
    </ng-container>
    <ng-container matColumnDef="naoconcluidos">
      <th mat-header-cell *matHeaderCellDef> NÃO CONCLUÍDOS </th>
      <td mat-cell *matCellDef="let element"> {{element.naoconcluidos}} </td>
      <td mat-footer-cell *matFooterCellDef> {{ getTotalNaoConcluidos() }} </td>
    </ng-container>
    <ng-container *ngIf="dataSource[0].atendentes[0].mediaEspera" matColumnDef="mediaEspera">
      <th mat-header-cell *matHeaderCellDef> Média de ESPERA </th>
      <td mat-cell *matCellDef="let element"> {{element.mediaEspera}} </td>
      <td mat-footer-cell *matFooterCellDef> </td>
    </ng-container>
    <ng-container *ngIf="dataSource[0].atendentes[0].mediaAtd" matColumnDef="mediaAtd">
      <th mat-header-cell *matHeaderCellDef> Média de ATENDIMENTO </th>
      <td mat-cell *matCellDef="let element"> {{element.mediaAtd}} </td>
      <td mat-footer-cell *matFooterCellDef> </td>
    </ng-container>
    <ng-container matColumnDef="expandedDetail">
    <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
      <div class="example-element-detail"
            [@detailExpand]="element == expandedElement ? 'expanded' : 'expanded'">
        <div *ngFor="let atendente of element.atendentes" class="row example-element-description">
          <div [ngClass]="{'col-4': atendente.mediaEspera === undefined, 'elem-atd-nome': true}">{{atendente.nome}}</div>
          <div [ngClass]="{'col-2': atendente.mediaEspera === undefined, 'elem-atd-agendados': true}"> {{atendente.agendados}}</div>
          <div [ngClass]="{'col-2': atendente.mediaEspera === undefined, 'elem-atd-concluidos': true}"> {{atendente.concluidos}}</div>
          <div [ngClass]="{'col-2': atendente.mediaEspera === undefined, 'elem-atd-cancelados': true}"> {{atendente.cancelados}}</div>
          <div [ngClass]="{'col-2': atendente.mediaEspera === undefined, 'elem-atd-naoconcluidos': true}"> {{atendente.naoconcluidos}}</div>
          <div class="elem-atd-mediaEspera"> {{atendente.mediaEspera}}</div>
          <div class="elem-atd-mediaAtd"> {{atendente.mediaAtd}}</div>
        </div>
      </div>
    </td>
    </ng-container>
  -->
    <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
    <tr mat-row *matRowDef="let element; columns: columnsToDisplay;"class="example-element-row"></tr>
   <!--[class.example-expanded-row]="expandedElement === element"
      (click)="expandedElement = expandedElement === element ? null : element" <tr mat-row *matRowDef="let row; columns: ['expandedDetail']"class="example-detail-row"></tr>
    <tr mat-footer-row *matFooterRowDef="columnsToDisplay"></tr>-->
  </table>
</div>
<div class="col-1"></div>
<div id="outs-teste" class="col-2">
    <div class="example-container row">
      <h4>Métricas</h4>
      <div 
        id="metricasout"
        cdkDropList
        [cdkDropListData]="metricasOut"
        cdkDropListConnectedTo="metricasin"
        class="example-list"
        (cdkDropListDropped)="drop($event)">
      <div
        class="example-box"
        *ngFor="let metrica of metricasOut"
        [cdkDragData]="metrica"
        cdkDrag>{{metrica}}</div>
      </div>
   </div>
    <div class="example-container row">
      <h4>Dimensões</h4>
      <div
        id="dimensoesOut"
        cdkDropList
        [cdkDropListData]="dimensoesOut"
        [cdkDropListConnectedTo]="['dimensoesIn', 'colunasIn']"
        class="example-list"
        (cdkDropListDropped)="drop($event)">
          <div
            class="example-box"
            *ngFor="let dim of dimensoesOut"
            [cdkDragData]="dim"
            cdkDrag>{{dim}}</div>
        </div>
    </div> 
  </div>
</div>
<div class="row">
  <div class="trigger-charts col-9">
    <div id="charts">
        <canvas id="horariosPico" baseChart [datasets]="chartData" [labels]="aggregator.barChartLabels" [options]="aggregator.barChartOptions" [legend]="aggregator.barChartLegend"
            [chartType]="aggregator.barChartType"></canvas>
    </div>
    <!--[colors]="aggregator.barChartColors"<ng-container *ngTemplateOutlet="chartVisOpts"></ng-container>-->
  </div>
</div>
<!--gráficos de performance-->
<div class="row">
  <div class="trigger-charts col-6">
    <div>
      <canvas baseChart id="perfServico" [datasets]="dataPerfServico" [labels]="aggrePerfServico.barChartLabels" [options]="aggrePerfServico.barChartOptions" [legend]="aggrePerfServico.barChartLegend"
            [chartType]="aggrePerfServico.barChartType"></canvas>
    </div>
    <!--<ng-container *ngTemplateOutlet="chartVisOpts"></ng-container>-->
  </div>
  <div class="trigger-charts col-6">
    <div>
        <canvas baseChart id="perfTotal" [datasets]="dataPerformance" [options]="aggrePerformance.barChartOptions" [legend]="aggrePerformance.barChartLegend"
              [chartType]="aggrePerformance.barChartType"></canvas>
    </div>
    <!--<ng-container *ngTemplateOutlet="chartVisOpts"></ng-container>-->
  </div>
</div>
<!--gráficos de avaliações-->
<div class="row">
  <div class="trigger-charts col-6">
    <div>
       <canvas baseChart id="classMediaServico" [datasets]="dataFeedback" [labels]="aggreFeedback.barChartLabels" [options]="aggreFeedback.barChartOptions" [legend]="aggreFeedback.barChartLegend"
              [chartType]="aggreFeedback.barChartType" [colors]="aggreFeedback.barChartColors"></canvas>
    </div>
    <!--<ng-container *ngTemplateOutlet="chartVisOpts"></ng-container>-->
  </div>
  <div class="trigger-charts col-6">
    <div>
      <canvas baseChart id="classMediaMes" [datasets]="dataClassMedia" [labels]="aggreClassMedia.barChartLabels" [options]="aggreClassMedia.barChartOptions" [legend]="aggreClassMedia.barChartLegend"
              [chartType]="aggreClassMedia.barChartType" [colors]="aggreClassMedia.barChartColors"></canvas>
    </div>
    <!--<ng-container *ngTemplateOutlet="chartVisOpts"></ng-container>-->
  </div>
</div>
<ng-template #chartVisOpts>
  <div id="available-charts">
    <div>
      <fa-icon (click)="changeToBarChart($event)" [icon]="faChartBar"></fa-icon>
    </div>
    <div>
      <fa-icon (click)="changeToLineChart($event)" [icon]="faChartLine"></fa-icon>
    </div>
    <!--<div>
      <fa-icon (click)="changeToAreaChart()" [icon]="faChartArea"></fa-icon>
    </div>-->
  </div>
 </ng-template> 